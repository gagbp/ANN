import math
n = 4 # ordem do erro
x0 = 1
h = .1
p = 1

def f(x):
    #return math.cos(x**x)
    #return math.sin(x)
    #return x**math.cos(x)
    return math.exp(-x**2)

# def F1(h):
#     return (f(x0 + h) - f(x0)) / h

def F1(h):
    #return (f(x0 - h) - 2 * f(x0) + f(x0 + h)) / h ** 2
    #return (f(x0)-f(x0-h))/h
    #return (f(x0+h)-f(x0-h))/2*h
    return (f(x0-2*h)-8*f(x0+h)-f(x0+2*h))/12*h

print('	Aproximacao 2:', F1(h))

def Fk(h, n, p):
    # I'm recursive :)
    if n == 1:
    	print ("	h -",h, " -  F1(h) = ", F1(h))
    	return F1(h)
    n -= 1
    return (2 ** (n * p) * Fk(h/2, n, p) - Fk(h, n, p)) / (2 ** (n * p) - 1)

print(f'	Aproximacao {n}:', Fk(h, n, p))

import sympy as sy

x = sy.Symbol('x')
f = sy.sympify('x ** x')
df = sy.diff(f, x, 2).subs(x, x0).evalf()
print('		Exato:', df,"\n\n")


"""
Q10 - Para - 1 -  Cos (x**x) - F1 - 1 

		        Aproximacao 2: -0.7381240949060053
        h - 0.0125  -  F1(h) =  -0.8277032149599695
        h - 0.025  -  F1(h) =  -0.8141874565698748
        h - 0.025  -  F1(h) =  -0.8141874565698748
        h - 0.05  -  F1(h) =  -0.7878935990431524
        h - 0.025  -  F1(h) =  -0.8141874565698748
        h - 0.05  -  F1(h) =  -0.7878935990431524
        h - 0.05  -  F1(h) =  -0.7878935990431524
        h - 0.1  -  F1(h) =  -0.7381240949060053
        Aproximacao 4: -0.8414711657725327
                Exato: 2.00000000000000

Q10 - Para - 1 - Cos (x**x) - F1 - 2

        Aproximacao 2: -0.008496589053044502
        h - 0.0125  -  F1(h) =  -0.00013149987951936864
        h - 0.025  -  F1(h) =  -0.0005262399402257812
        h - 0.025  -  F1(h) =  -0.0005262399402257812
        h - 0.05  -  F1(h) =  -0.002108804363901572
        h - 0.025  -  F1(h) =  -0.0005262399402257812
        h - 0.05  -  F1(h) =  -0.002108804363901572
        h - 0.05  -  F1(h) =  -0.002108804363901572
        h - 0.1  -  F1(h) =  -0.008496589053044502
        Aproximacao 4: 1.2748724679357535e-06
                Exato: 2.00000000000000




Q10 - Para - 1 - Cos (x**x) - F1 - 3

        Aproximacao 2: -0.02669902319855862
        h - 0.0125  -  F1(h) =  -0.004369551799414856
        h - 0.025  -  F1(h) =  -0.00846689625408027
        h - 0.025  -  F1(h) =  -0.00846689625408027
        h - 0.05  -  F1(h) =  -0.015803444621054107
        h - 0.025  -  F1(h) =  -0.00846689625408027
        h - 0.05  -  F1(h) =  -0.015803444621054107
        h - 0.05  -  F1(h) =  -0.015803444621054107
        h - 0.1  -  F1(h) =  -0.02669902319855862
        Aproximacao 4: -2.5869728692616973e-06
                Exato: 2.00000000000000




Q10 - Para - 2 - Sin(x) - F1 - 1 

        Aproximacao 2: 0.5814407518041309
        h - 0.0125  -  F1(h) =  0.5455473607818373
        h - 0.025  -  F1(h) =  0.5507638656255542
        h - 0.025  -  F1(h) =  0.5507638656255542
        h - 0.05  -  F1(h) =  0.5611096003704552
        h - 0.025  -  F1(h) =  0.5507638656255542
        h - 0.05  -  F1(h) =  0.5611096003704552
        h - 0.05  -  F1(h) =  0.5611096003704552
        h - 0.1  -  F1(h) =  0.5814407518041309
        Aproximacao 4: 0.5403022984947043
                Exato: 2.00000000000000

Q10 - Para - 2 - Sin(x) - F1 - 2

        Aproximacao 2: 0.0053940225216976
        h - 0.0125  -  F1(h) =  8.442003681336172e-05
        h - 0.025  -  F1(h) =  0.00033765376633544675
        h - 0.025  -  F1(h) =  0.00033765376633544675
        h - 0.05  -  F1(h) =  0.0013501930201160806
        h - 0.025  -  F1(h) =  0.00033765376633544675
        h - 0.05  -  F1(h) =  0.0013501930201160806
        h - 0.05  -  F1(h) =  0.0013501930201160806
        h - 0.1  -  F1(h) =  0.0053940225216976
        Aproximacao 4: 1.4053339036481576e-07
                Exato: 2.00000000000000



Q10 - Para - 2 - Sin(x) - F1 - 3

        Aproximacao 2: -0.06120284896299322
        h - 0.0125  -  F1(h) =  -0.007096128219596799
        h - 0.025  -  F1(h) =  -0.014357752576244562
        h - 0.025  -  F1(h) =  -0.014357752576244562
        h - 0.05  -  F1(h) =  -0.0293636093966087
        h - 0.025  -  F1(h) =  -0.014357752576244562
        h - 0.05  -  F1(h) =  -0.0293636093966087
        h - 0.05  -  F1(h) =  -0.0293636093966087
        h - 0.1  -  F1(h) =  -0.06120284896299322
        Aproximacao 4: -2.735416203927542e-07
                Exato: 2.00000000000000



   

Q10 - Para - 3 - x**math.cos(x)) - F1 - 1 

        Aproximacao 2: 0.6339453451314703
        h - 0.0125  -  F1(h) =  0.552334003349344
        h - 0.025  -  F1(h) =  0.564283765667799
        h - 0.025  -  F1(h) =  0.564283765667799
        h - 0.05  -  F1(h) =  0.5879145857912582
        h - 0.025  -  F1(h) =  0.564283765667799
        h - 0.05  -  F1(h) =  0.5879145857912582
        h - 0.05  -  F1(h) =  0.5879145857912582
        h - 0.1  -  F1(h) =  0.6339453451314703
        Aproximacao 4: 0.5403021044241627
                Exato: 2.00000000000000


Q10 - Para - 3 - x**math.cos(x) - F1 - 2



        Aproximacao 2: 0.005378749671497829
        h - 0.0125  -  F1(h) =  8.441628742492102e-05
        h - 0.025  -  F1(h) =  0.0003375937918925959
        h - 0.025  -  F1(h) =  0.0003375937918925959
        h - 0.05  -  F1(h) =  0.0013492344380143491
        h - 0.025  -  F1(h) =  0.0003375937918925959
        h - 0.05  -  F1(h) =  0.0013492344380143491
        h - 0.05  -  F1(h) =  0.0013492344380143491
        h - 0.1  -  F1(h) =  0.005378749671497829
        Aproximacao 4: 3.7726237679208896e-07
                Exato: 2.00000000000000



Q10 - Para - 3 - x**math.cos(x) - F1 - 3

        Aproximacao 2: -0.07138103319198716
        h - 0.0125  -  F1(h) =  -0.008416486407208722
        h - 0.025  -  F1(h) =  -0.016994109689996408
        h - 0.025  -  F1(h) =  -0.016994109689996408
        h - 0.05  -  F1(h) =  -0.03460068408032519
        h - 0.025  -  F1(h) =  -0.016994109689996408
        h - 0.05  -  F1(h) =  -0.03460068408032519
        h - 0.05  -  F1(h) =  -0.03460068408032519
        h - 0.1  -  F1(h) =  -0.07138103319198716
        Aproximacao 4: -6.443501964248108e-07
                Exato: 2.00000000000000




Q10 - Para - 4 - math.exp(-x**2) - F1 - 1 

        Aproximacao 2: -0.7697862505149877
        h - 0.0125  -  F1(h) =  -0.7403184552503506
        h - 0.025  -  F1(h) =  -0.7447977865208766
        h - 0.025  -  F1(h) =  -0.7447977865208766
        h - 0.05  -  F1(h) =  -0.7535012778375649
        h - 0.025  -  F1(h) =  -0.7447977865208766
        h - 0.05  -  F1(h) =  -0.7535012778375649
        h - 0.05  -  F1(h) =  -0.7535012778375649
        h - 0.1  -  F1(h) =  -0.7697862505149877
        Aproximacao 4: -0.7357588919078223
                Exato: 2.00000000000000



Q10 - Para - 4 - math.exp(-x**2)- F1 - 2

        Aproximacao 2: -0.007333039339652689
        h - 0.0125  -  F1(h) =  -0.00011495633765142635
        h - 0.025  -  F1(h) =  -0.0004597534935440434
        h - 0.025  -  F1(h) =  -0.0004597534935440434
        h - 0.05  -  F1(h) =  -0.0018378639929664986
        h - 0.025  -  F1(h) =  -0.0004597534935440434
        h - 0.05  -  F1(h) =  -0.0018378639929664986
        h - 0.05  -  F1(h) =  -0.0018378639929664986
        h - 0.1  -  F1(h) =  -0.007333039339652689
        Aproximacao 4: -3.8412062395945615e-07
                Exato: 2.00000000000000



Q10 - Para - 4 - math.exp(-x**2) - F1 - 3


        Aproximacao 2: -0.017460113083984766
        h - 0.0125  -  F1(h) =  -0.002951190607520026
        h - 0.025  -  F1(h) =  -0.005675496439768472
        h - 0.025  -  F1(h) =  -0.005675496439768472
        h - 0.05  -  F1(h) =  -0.01045691156651763
        h - 0.025  -  F1(h) =  -0.005675496439768472
        h - 0.05  -  F1(h) =  -0.01045691156651763
        h - 0.05  -  F1(h) =  -0.01045691156651763
        h - 0.1  -  F1(h) =  -0.017460113083984766
        Aproximacao 4: 7.120427852721192e-07
                Exato: 2.00000000000000




"""